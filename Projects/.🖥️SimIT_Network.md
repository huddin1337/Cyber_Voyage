# Gothem HomeLab
In preparations for setting up my whole Lab. I will be using a various VM hosting a Windows Server 2025, Windows 11 enterprise, Ubuntu desktop, Ubuntu server, security onion, and a Kali Linux VM.
# Phase 1 (Setting up DC)
1. Initial Setup and Configuration
The first step was to install Windows Server 2025 on a virtual machine (VM). A crucial part of this initial configuration was to set a static IP address. This ensures that the domain controller's address remains constant, preventing connectivity issues for all devices and services relying on it.

Action: Configure a static IP address on the Windows Server 2025 VM.

Reasoning: A static IP is essential for a domain controller, as its address must be dependable for client machines to locate and communicate with it.

2. Installing Core Server Roles
After the initial setup, I used the Add Roles and Features wizard to install the necessary services for my domain controller.

Active Directory Domain Services (AD DS): This is the core service for managing user accounts, computers, and other network resources. It is the foundation of my domain.

DHCP Server: This service will automatically assign IP addresses to devices on the network. Although many of my lab machines will use static IPs, this is a valuable service to have for future expansion and for practice.

DNS Server: This is a critical role that translates domain names into IP addresses. It's essential for all devices to correctly find resources within my new domain.

<img width="975" height="445" alt="image" src="https://github.com/user-attachments/assets/ed2da438-94ec-43c8-b1ee-f3e8b7cea610" />


3. Promoting the Server to a Domain Controller
Following the installation of the roles, I was prompted with post-deployment configuration messages. This is the stage where the server is officially promoted to a domain controller.

Action: From the Server Manager, I selected Promote this server to a domain controller.

Deployment Method: I chose Add a new forest and named the root domain Gotham.Wayne-corp-dc.com.

Configuration: I set the Directory Services Restore Mode (DSRM) password and proceeded with the default settings for the remaining options until installation.

After a reboot, the server was successfully logging in to the new domain, WAYNE-CORP-DC, with the administrator account.

<img width="534" height="528" alt="image" src="https://github.com/user-attachments/assets/9c567417-ffd6-45c1-80c6-02090c46d890" />

<img width="684" height="592" alt="image" src="https://github.com/user-attachments/assets/340609ec-2451-4225-a6d6-21aa163d9cf3" />



4. Configuring DNS
A properly configured DNS server is critical for the domain to function correctly. I configured a lookup zone and added an external forwarder to ensure the server can resolve both internal and external requests.

DNS Manager: I navigated to the DNS Manager within Server Manager.

Forwarders: I accessed the server's properties, went to the Forwarders tab, and added Google's public DNS servers (8.8.8.8 and 8.8.4.4). This allows the domain controller to forward unresolved requests for internet domains to a reliable external source.

5. Configuring DHCP
Even though most of the key machines in my lab will have static IPs, configuring the DHCP server is a valuable exercise and provides flexibility for new devices.

DHCP Manager: In the DHCP Manager, I right-clicked on IPv4 and selected New Scope.

Scope Name: I named the new scope wayne-corp-scope.

IP Address Range: I configured the scope to assign IP addresses in the range of 10.0.0.100 to 10.0.0.200.

Default Gateway: I set the default gateway to 10.0.0.1. Any device receiving an IP from this range will use this gateway to access the internet.

Finalization: I continued with the default settings to complete the wizard and activate the scope.

<img width="813" height="653" alt="image" src="https://github.com/user-attachments/assets/1a6b06dd-6798-4f9a-bf75-5f6d5d0f4010" />


6. Managing Active Directory Users and Computers
Now that the domain controller is operational, I can start populating it with users, organizational units (OUs), and Group Policy Objects (GPOs).

Tool: To add users, I opened Active Directory Users and Computers from the Server Manager's Tools menu.

Creating a New User: To add a new user, I right-clicked within an OU, selected New, and then User. This will be used to create fictional employee accounts for testing and demonstration purposes.

<img width="975" height="794" alt="image" src="https://github.com/user-attachments/assets/f77a22c8-6791-40ec-b710-dfd5fc7d93d6" />

---

## Phase 2: Configuring Windows 11 Enterprise Desktop

After setting up a clean Windows 11 Enterprise VM, I connected it to Active Directory:

1. **Static IP Configuration**  
   - IP Address: `10.0.0.100`  
   - Subnet Mask: `255.255.255.0`  
   - Gateway: `10.0.0.1`  
   - DNS Server: `10.0.0.5`  

2. **Join Active Directory**  
   - Open **Control Panel > System Properties > Change**.  
   - Rename PC: `Wayne-corp-win`.  
   - Domain: `Gotham.Wayne-corp-dc.com`.  
   - Restart after applying settings.  

3. **Domain Login**  
   - Logged in with a pre-created AD user.  
   - Windows applied AD policies and completed setup.  

---

## Phase 3: Configuring Ubuntu Desktop with Active Directory

### Network Setup
- Set a static IP, gateway, and DNS (`10.0.0.5`) under **Settings > Network**.  

### Install Samba + Winbind
```bash
## update everytime to ensure latest repo
sudo apt update && sudo apt upgrade -y

## How I installed winbind, fill all boxs with the domain in caps "GOTHAM.WAYNE-CORP-DC.COM" three times.
apt -y install winbind libpam-winbind libnss-winbind krb5-config samba-dsdb-modules samba-vfs-modules

##Next move the smb.conf to smb.conf.org and nano a new smb.conf, where we will past the following promt...
sudo nano /etc/samba/smb.conf
  ##Insert this...
[global]
   kerberos method = secrets and keytab
   realm = GOTHAM.WAYNE-CORP-DC.COM ##<-------- CHANGE THIS
   workgroup = GOTHAM ##<-------- CHANGE THIS
   security = ads
   template shell = /bin/bash
   winbind enum groups = Yes
   winbind enum users = Yes
   winbind separator = +
   idmap config * : rangesize = 1000000
   idmap config * : range = 1000000-19999999
   idmap config * : backend = autorid

##Using a text editor edit this file by adding "winbind" to the end of passwd and groups.
sudo nano /etc/nsswitch.conf


## To ensure that a home directory is created upon logging in we're going to use the command, hit spacebar on create directory:
sudo pam-auth-update

#add another line called name server and then adding the IP address 10.0.0.5. 
sudo nano /etc/resolv.conf

## Now before we begin to log in, we're going to run the systemctl restart windbind command. After a successful restart we can run this command tool log into the administrator account: 
sudo net ads join -U Administrator

## Once we have successfully completed that we're able to run the command to see the other accounts associated with this Active Directory.
wbinfo â€“ u

## To log in simply we run the sudo login which will prompt us to enter a login and a password. After which we will see a message saying a home directory was created for this user and it will log in as that user.

```
Sources "https://hdtodayz.to/watch-tv/watch-that-70s-show-hd-39144.4936348" 


